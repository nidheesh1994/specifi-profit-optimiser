import{k as d,i as D,f as r,o as u,a as k,u as j,g as H,w as C,b as e,h as f,n as Q,t as o,F as h,l as P,j as n,m as i,v as T,J as q}from"./app-eZH31WVS.js";import{_ as z}from"./AuthenticatedLayout-DpeZLVQt.js";import"./ApplicationLogo-Bqqv3aaq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"py-12"},E={class:"max-w-5xl mx-auto bg-white p-6 rounded shadow"},F={key:0,class:"mb-6"},O={class:"w-full text-left border"},$={class:"px-4 py-2"},A={class:"px-4 py-2"},J={class:"px-4 py-2"},K={class:"px-4 py-2"},I={class:"px-4 py-2"},G={class:"px-4 py-2"},R={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},W={key:0,class:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center"},X={class:"bg-white p-6 rounded shadow-lg max-w-6xl w-full"},Y={class:"max-h-80 overflow-y-auto border rounded mb-4"},Z={class:"w-full text-left"},ee={class:"px-4 py-2"},te=["value"],se={class:"px-4 py-2"},le={class:"px-4 py-2"},oe={class:"px-4 py-2"},ae={class:"px-4 py-2"},re={class:"px-4 py-2"},ue={class:"px-4 py-2"},ne={class:"flex justify-end space-x-2"},ce={__name:"Create",props:{products:Array,settings:Object},setup(V){const p=V,v=d(!1),g=d([]),y=d([]),m=d([]),c=d(""),L=D(()=>{if(!c.value)return p.products;const a=c.value.toLowerCase();return p.products.filter(t=>{var s,_,w;return((s=t.name)==null?void 0:s.toLowerCase().includes(a))||((_=t.sku)==null?void 0:_.toLowerCase().includes(a))||((w=t.mpn)==null?void 0:w.toLowerCase().includes(a))})}),S=()=>{y.value=[...m.value],g.value=m.value.map(a=>a.id),v.value=!1},U=()=>{m.value=[...y.value],v.value=!0,c.value=""},b=d(null),x=(a,t="error")=>{b.value={message:a,type:t},setTimeout(()=>b.value=null,3e3)},l=d({customer_name:"",customer_address:"",labor_hours:"",labor_cost_per_hour:"",fixed_overheads:"",target_profit_margin:""}),N=()=>{l.value.labor_hours=p.settings.labor_hours,l.value.labor_cost_per_hour=p.settings.labor_cost_per_hour,l.value.fixed_overheads=p.settings.fixed_overheads,l.value.target_profit_margin=p.settings.target_profit_margin},M=()=>{if(g.value.length===0){x("Please select at least one product.");return}if(!l.value.customer_name){x("Customer name is required");return}if(!l.value.labor_hours||l.value.labor_hours<=0){x("Estimated Labor Hours must be greater than 0.");return}if(!l.value.labor_cost_per_hour||l.value.labor_cost_per_hour<=0){x("Labor Cost Per Hour must be greater than 0.");return}q.post(route("quotes.store"),{products:g.value,...l.value})};return(a,t)=>(u(),r(h,null,[k(j(H),{title:"Profit Optimiser"}),k(z,null,{header:C(()=>t[9]||(t[9]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Create Qoutes",-1)])),default:C(()=>[e("div",B,[b.value?(u(),r("div",{key:0,class:Q(`fixed top-20 right-20 px-4 py-2 rounded shadow text-white z-50 ${b.value.type==="error"?"bg-red-600":"bg-green-600"}`)},o(b.value.message),3)):f("",!0),e("div",E,[e("button",{onClick:U,class:"mb-4 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700"}," Select Products "),y.value.length?(u(),r("div",F,[e("table",O,[t[10]||(t[10]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Name"),e("th",{class:"px-4 py-2"},"Category"),e("th",{class:"px-4 py-2"},"SKU"),e("th",{class:"px-4 py-2"},"MPN"),e("th",{class:"px-4 py-2"},"Cost"),e("th",{class:"px-4 py-2"},"Sell")])],-1)),e("tbody",null,[(u(!0),r(h,null,P(y.value,s=>(u(),r("tr",{key:s.id,class:"border-b"},[e("td",$,o(s.name),1),e("td",A,o(s.category),1),e("td",J,o(s.sku),1),e("td",K,o(s.mpn),1),e("td",I,"£"+o(s.trade_price),1),e("td",G,"£"+o(s.retail_price),1)]))),128))])])])):f("",!0),e("div",R,[e("div",null,[t[11]||(t[11]=e("label",{class:"block font-medium mb-1"},"Customer Name",-1)),n(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>l.value.customer_name=s),class:"w-full border px-3 py-2 rounded"},null,512),[[i,l.value.customer_name]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block font-medium mb-1"},"Customer Address",-1)),n(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>l.value.customer_address=s),class:"w-full border px-3 py-2 rounded"},null,512),[[i,l.value.customer_address]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block font-medium mb-1"},"Estimated Labor Hours",-1)),n(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=s=>l.value.labor_hours=s),class:"w-full border px-3 py-2 rounded"},null,512),[[i,l.value.labor_hours]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block font-medium mb-1"},"Labor Cost Per Hour (£)",-1)),n(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=s=>l.value.labor_cost_per_hour=s),class:"w-full border px-3 py-2 rounded"},null,512),[[i,l.value.labor_cost_per_hour]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block font-medium mb-1"},"Fixed Overheads (£)",-1)),n(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.fixed_overheads=s),class:"w-full border px-3 py-2 rounded"},null,512),[[i,l.value.fixed_overheads]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block font-medium mb-1"},"Target Profit Margin (%)",-1)),n(e("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=s=>l.value.target_profit_margin=s),class:"w-full border px-3 py-2 rounded"},null,512),[[i,l.value.target_profit_margin]])])]),e("button",{onClick:N,class:"mb-4 bg-gray-300 px-4 py-2 rounded hover:bg-gray-400"}," Load Default "),e("button",{onClick:M,class:"ml-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"}," Create Quote ")])]),v.value?(u(),r("div",W,[e("div",X,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold mb-4"},"Select Products",-1)),n(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=s=>c.value=s),placeholder:"Search products...",class:"w-full border px-3 py-2 rounded mb-4"},null,512),[[i,c.value]]),e("div",Y,[e("table",Z,[t[17]||(t[17]=e("thead",{class:"bg-gray-100 sticky top-0"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Select"),e("th",{class:"px-4 py-2"},"Name"),e("th",{class:"px-4 py-2"},"Category"),e("th",{class:"px-4 py-2"},"SKU"),e("th",{class:"px-4 py-2"},"MPN"),e("th",{class:"px-4 py-2"},"Cost"),e("th",{class:"px-4 py-2"},"Sell")])],-1)),e("tbody",null,[(u(!0),r(h,null,P(L.value,s=>(u(),r("tr",{key:s.id,class:"border-b"},[e("td",ee,[n(e("input",{type:"checkbox",value:s,"onUpdate:modelValue":t[7]||(t[7]=_=>m.value=_)},null,8,te),[[T,m.value]])]),e("td",se,o(s.name),1),e("td",le,o(s.category),1),e("td",oe,o(s.sku),1),e("td",ae,o(s.mpn),1),e("td",re,"£"+o(s.trade_price),1),e("td",ue,"£"+o(s.retail_price),1)]))),128))])])]),e("div",ne,[e("button",{onClick:t[8]||(t[8]=s=>v.value=!1),class:"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400"}," Cancel "),e("button",{onClick:S,class:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700"}," Done ")])])])):f("",!0)]),_:1})],64))}};export{ce as default};
